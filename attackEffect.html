<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VYRUS Attack Effect Explained</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #111827;
            color: #e5e7eb;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1, h2 {
            color: #fbbf24;
            text-align: center;
        }
        .section {
            background-color: #1f2937;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #374151;
        }
        .code-block {
            background-color: #111827;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            border: 1px solid #374151;
        }
        .highlight {
            background-color: #374151;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .variable {
            color: #f87171;
        }
        .function {
            color: #60a5fa;
        }
        .comment {
            color: #a3a3a3;
        }
        .canvas-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        canvas {
            border: 1px solid #374151;
            background-color: #0f172a;
        }
        .timeline {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            position: relative;
        }
        .timeline::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 4px;
            background: #374151;
            z-index: 1;
        }
        .timeline-point {
            position: relative;
            text-align: center;
            z-index: 2;
            background: #1f2937;
            padding: 10px;
            border-radius: 8px;
            width: 120px;
        }
        .timeline-label {
            font-size: 12px;
            color: #9ca3af;
        }
        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .color-box {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>VYRUS Attack Effect Explained</h1>
        
        <div class="section">
            <h2>Overview</h2>
            <p>The attack effect in VYRUS is a visual representation of when one virus attacks another. It appears as a radial wave expanding from the point of collision between two virus cells.</p>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="color-box" style="background: #EF4444;"></div>
                    <span>Player 1 (Red)</span>
                </div>
                <div class="legend-item">
                    <div class="color-box" style="background: #3B82F6;"></div>
                    <span>Player 2 (Blue)</span>
                </div>
                <div class="legend-item">
                    <div class="color-box" style="background: #10B981;"></div>
                    <span>Player 3 (Green)</span>
                </div>
                <div class="legend-item">
                    <div class="color-box" style="background: #F59E0B;"></div>
                    <span>Player 4 (Yellow)</span>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Timeline of the Attack Effect</h2>
            <div class="timeline">
                <div class="timeline-point">
                    <strong>Start</strong>
                    <div class="timeline-label">t=0</div>
                </div>
                <div class="timeline-point">
                    <strong>Expand</strong>
                    <div class="timeline-label">t=0.3</div>
                </div>
                <div class="timeline-point">
                    <strong>Peak</strong>
                    <div class="timeline-label">t=0.7</div>
                </div>
                <div class="timeline-point">
                    <strong>Fade Out</strong>
                    <div class="timeline-label">t=1.0</div>
                </div>
            </div>
            <p>The attack effect occurs over a duration of approximately 600ms and consists of four phases:</p>
            <ol>
                <li><strong>Start</strong>: Effect begins at the collision point with zero radius</li>
                <li><strong>Expand</strong>: Radial wave expands outward from the center</li>
                <li><strong>Peak</strong>: Effect reaches maximum size and brightness</li>
                <li><strong>Fade Out</strong>: Effect gradually fades as the animation completes</li>
            </ol>
        </div>

        <div class="section">
            <h2>Canvas Visualization</h2>
            <div class="canvas-container">
                <canvas id="attackEffectCanvas" width="600" height="400"></canvas>
            </div>
        </div>

        <div class="section">
            <h2>Code Implementation in CanvasGrid.tsx</h2>
            <p>This is the actual code responsible for rendering the attack effect:</p>
            <div class="code-block">
                <span class="comment">// Make attack effect 10x larger, brighter and slower</span><br>
                <span class="keyword">const</span> slowProgress = <span class="function">Math.min</span>(<span class="number">1</span>, progress / <span class="number">0.1</span>); <span class="comment">// 10x slower</span><br>
                <span class="keyword">const</span> attackRadius = <span class="number">60</span> * slowProgress; <span class="comment">// Much larger radius</span><br><br>
                
                ctx.<span class="function">beginPath</span>();<br>
                ctx.<span class="function">arc</span>(x, y, attackRadius, <span class="number">0</span>, <span class="number">2</span> * <span class="function">Math.PI</span>);<br>
                rgbColor = <span class="function">hexToRgb</span>(effect.color);<br>
                <span class="keyword">if</span> (rgbColor) {<br>
                &nbsp;&nbsp;<span class="comment">// Create gradient with high contrast and increased brightness (fully opaque at center)</span><br>
                &nbsp;&nbsp;<span class="keyword">const</span> attackGradient = ctx.<span class="function">createRadialGradient</span>(x, y, <span class="number">0</span>, x, y, attackRadius);<br>
                &nbsp;&nbsp;attackGradient.<span class="function">addColorStop</span>(<span class="number">0</span>, <span class="string">`rgba(${rgbColor.r}, ${rgbColor.g}, ${rgbColor.b}, 1.0)`</span>); <span class="comment">// Fully opaque at center</span><br>
                &nbsp;&nbsp;attackGradient.<span class="function">addColorStop</span>(<span class="number">0.7</span>, <span class="string">`rgba(${rgbColor.r}, ${rgbColor.g}, ${rgbColor.b}, 1.0)`</span>); <span class="comment">// Fully opaque in middle</span><br>
                &nbsp;&nbsp;attackGradient.<span class="function">addColorStop</span>(<span class="number">1</span>, <span class="string">`rgba(${rgbColor.r}, ${rgbColor.g}, ${rgbColor.b}, 0.0)`</span>); <span class="comment">// Transparent at edges</span><br>
                &nbsp;&nbsp;ctx.<span class="function">fillStyle</span> = attackGradient;<br>
                &nbsp;&nbsp;ctx.<span class="function">fill</span>();<br>
                }
            </div>
        </div>

        <div class="section">
            <h2>Code Implementation in CanvasGridOptimized.tsx</h2>
            <p>This is the code for the optimized grid renderer:</p>
            <div class="code-block">
                <span class="comment">// Enhanced rendering for attack effects</span><br>
                <span class="keyword">if</span> (effect.type === <span class="string">'attack'</span>) {<br>
                &nbsp;&nbsp;<span class="comment">// Make attack effects 10x larger, brighter and slower</span><br>
                &nbsp;&nbsp;<span class="keyword">const</span> slowProgress = <span class="function">Math.min</span>(<span class="number">1</span>, progress / <span class="number">0.1</span>); <span class="comment">// 10x slower</span><br>
                &nbsp;&nbsp;<span class="keyword">const</span> expandedRadius = <span class="number">60</span> * slowProgress; <span class="comment">// Much larger radius</span><br><br>
                
                &nbsp;&nbsp;ctx.<span class="function">beginPath</span>();<br>
                &nbsp;&nbsp;ctx.<span class="function">arc</span>(x, y, expandedRadius, <span class="number">0</span>, <span class="number">2</span> * <span class="function">Math.PI</span>);<br>
                &nbsp;&nbsp;ctx.<span class="function">fillStyle</span> = effect.color; <span class="comment">// Fully opaque</span><br>
                &nbsp;&nbsp;ctx.<span class="function">fill</span>();<br>
                } <span class="keyword">else</span> {<br>
                &nbsp;&nbsp;<span class="comment">// Basic rendering for other effects</span><br>
                &nbsp;&nbsp;ctx.<span class="function">beginPath</span>();<br>
                &nbsp;&nbsp;ctx.<span class="function">arc</span>(x, y, <span class="number">5</span> * progress, <span class="number">0</span>, <span class="number">2</span> * <span class="function">Math.PI</span>);<br>
                &nbsp;&nbsp;ctx.<span class="function">fillStyle</span> = effect.color;<br>
                &nbsp;&nbsp;ctx.<span class="function">globalAlpha</span> = <span class="number">0.7</span>;<br>
                &nbsp;&nbsp;ctx.<span class="function">fill</span>();<br>
                &nbsp;&nbsp;ctx.<span class="function">globalAlpha</span> = <span class="number">1</span>;<br>
                }
            </div>
        </div>

        <div class="section">
            <h2>Variable Explanations</h2>
            <ul>
                <li><span class="variable">progress</span>: A value from 0 to 1 indicating the current animation progress (0 = start, 1 = end)</li>
                <li><span class="variable">slowProgress</span>: The slowed-down progress value (progress divided by 0.1), making the animation 10x slower</li>
                <li><span class="variable">attackRadius</span>: The current radius of the attack effect, calculated based on slowProgress</li>
                <li><span class="variable">x, y</span>: The coordinates where the attack effect originates (collision point)</li>
                <li><span class="variable">rgbColor</span>: The RGB color values of the attacking virus</li>
                <li><span class="variable">attackGradient</span>: A radial gradient that creates the visual effect with varying opacity</li>
                <li><span class="variable">ctx</span>: The canvas 2D rendering context used to draw the effect</li>
            </ul>
        </div>

        <div class="section">
            <h2>Function Explanations</h2>
            <ul>
                <li><span class="function">Math.min(a, b)</span>: Returns the smaller of two numbers (used to cap progress at 1)</li>
                <li><span class="function">ctx.beginPath()</span>: Begins a new path for drawing</li>
                <li><span class="function">ctx.arc(x, y, radius, startAngle, endAngle)</span>: Draws an arc (circle in this case) at (x,y) with specified radius</li>
                <li><span class="function">ctx.createRadialGradient(x0, y0, r0, x1, y1, r1)</span>: Creates a radial gradient from one circle to another</li>
                <li><span class="function">gradient.addColorStop(position, color)</span>: Adds a color stop at a specific position in the gradient</li>
                <li><span class="function">ctx.fillStyle</span>: Sets the color or style to use inside shapes</li>
                <li><span class="function">ctx.fill()</span>: Fills the current path with the current fillStyle</li>
            </ul>
        </div>

        <div class="section">
            <h2>Visual Effect Timeline</h2>
            <p>At each stage of the animation:</p>
            <ol>
                <li><strong>t=0</strong>: Effect starts with radius 0, invisible at the collision point</li>
                <li><strong>t=0.1</strong>: Radius begins to grow rapidly, creating an expanding circle</li>
                <li><strong>t=0.3</strong>: Circle continues expanding, gradient becomes more visible</li>
                <li><strong>t=0.5</strong>: Halfway through animation, circle is at moderate size</li>
                <li><strong>t=0.7</strong>: Circle reaches peak size, gradient is most intense</li>
                <li><strong>t=1.0</strong>: Animation completes, effect fades out as gradient transparency increases at the edges</li>
            </ol>
        </div>
    </div>

    <script>
        // Animation for the attack effect visualization
        const canvas = document.getElementById('attackEffectCanvas');
        const ctx = canvas.getContext('2d');
        
        // Set canvas dimensions to match its display size
        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;
        
        let animationProgress = 0;
        let animationDirection = 1; // 1 for forward, -1 for backward
        
        function drawAttackEffect() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid background
            ctx.strokeStyle = '#374151';
            ctx.lineWidth = 1;
            for (let x = 0; x <= canvas.width; x += 40) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            for (let y = 0; y <= canvas.height; y += 40) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
            
            // Draw virus cells
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            
            // Draw two virus cells approaching each other
            ctx.beginPath();
            ctx.arc(centerX - 50, centerY, 15, 0, Math.PI * 2);
            ctx.fillStyle = '#EF4444'; // Red virus
            ctx.fill();
            ctx.strokeStyle = '#374151';
            ctx.lineWidth = 1;
            ctx.stroke();
            
            ctx.beginPath();
            ctx.arc(centerX + 50, centerY, 15, 0, Math.PI * 2);
            ctx.fillStyle = '#3B82F6'; // Blue virus
            ctx.fill();
            ctx.strokeStyle = '#374151';
            ctx.lineWidth = 1;
            ctx.stroke();
            
            // Calculate attack effect properties
            const slowProgress = Math.min(1, animationProgress / 0.1); // 10x slower
            const attackRadius = 60 * slowProgress; // Much larger radius
            
            // Create radial gradient for attack effect
            const gradient = ctx.createRadialGradient(
                centerX, centerY, 0, 
                centerX, centerY, attackRadius
            );
            
            // Add color stops for the gradient
            gradient.addColorStop(0, `rgba(239, 68, 68, 1.0)`); // Fully opaque at center
            gradient.addColorStop(0.7, `rgba(239, 68, 68, 1.0)`); // Fully opaque in middle
            gradient.addColorStop(1, `rgba(239, 68, 68, 0.0)`); // Transparent at edges
            
            // Draw the attack effect
            ctx.beginPath();
            ctx.arc(centerX, centerY, attackRadius, 0, Math.PI * 2);
            ctx.fillStyle = gradient;
            ctx.fill();
            
            // Update animation progress
            animationProgress += 0.01 * animationDirection;
            
            // Reverse direction at boundaries
            if (animationProgress >= 1) {
                animationProgress = 1;
                animationDirection = -1;
            } else if (animationProgress <= 0) {
                animationProgress = 0;
                animationDirection = 1;
            }
            
            // Continue animation
            requestAnimationFrame(drawAttackEffect);
        }
        
        // Start the animation
        drawAttackEffect();
    </script>
</body>
</html>